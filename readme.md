# Traffic Forecasting with VSET-Nets

### A VGAE Spatial Embedding for Temporal Networks Approach

A Python-based framework for traffic speed forecasting on road networks using Graph Convolution Networks (GCNs), Convolutional Neural Networks (CNNs) and various embedding techniques.

## Project Components

This project is organized into three main components:

1. **Dataset Creation**

   * Implemented in `data.py` via the `RoadDataset` class.
   * Reads raw CSV files from the `data/` folder.
   * Converts adjacency matrices to edge indices using a threshold.
   * Creates windowed graph samples (graphs with sliding time-series windows as node features).
   * Splits into train/test datasets and saves them as properties for downstream tasks.

2. **Graph Embeddings**

   * Two embedding approaches: **VGAE embeddings** and **Node2Vec embeddings**.
   * Trained on the `train_dataset` generated by `RoadDataset`.
   * Extracts and saves embedding vectors for both train and test splits.

3. **Downstream Forecasting**

   * Defined in `downstream_model.py`.
   * Uses a 1D CNN to capture temporal patterns in the time-series data.
   * Merges CNN output with graph embeddings (VGAE or Node2Vec) through additional neural network layers.
   * Generates final traffic speed predictions.
   * Also includes a baseline two-layer GCN trained directly on the `RoadDataset` (no embeddings) for performance comparison.

## Usage

Before running any scripts, install dependencies:

```bash
pip install -r requirements.txt
```


### Train and Evaluate Models

There are three main training scripts, each corresponding to a major experiment:

1. **Baseline GCN**

   ```bash
   python baseline_train.py
   ```

   Trains a simple two-layer GCN on the `RoadDataset` (no embeddings).

2. **VSET-Net (VGAE Embeddings)**

   ```bash
   python vsetnet_train.py
   ```

   Learns VGAE-based graph embeddings, then trains the downstream CNN+MLP model using those embeddings.

3. **Node2Vec Embeddings**

   ```bash
   python node2vec_train.py
   ```

   Learns Node2Vec embeddings and trains the downstream CNN+MLP model for comparison.

## File Structure

```
├── data/                       # Raw CSV data
│   ├── PeMSD7_V_228.csv       # Nodal time-series features
│   └── PeMSD7_W_228.csv       # Adjacency weight matrix
├── data.py                     # RoadDataset class and dataset creation
├── baseline_train.py           # Two-layer GCN baseline training
├── vsetnet_train.py            # VGAE embedding + downstream model training
├── node2vec_train.py           # Node2Vec embedding + downstream model training
├── downstream_model.py         # 1D CNN + embedding fusion model definitions
├── embedding_model.py          # Generic embedding model utilities
├── graph_embedding.py          # VGAE implementation and utilities
├── node2vec.py                 # Node2Vec embedding implementation
├── cnn_model.py                # Experiments running single CNN model downstream
├── .gitignore
└── README.md                   # This file
```


## Logging

Training logs are stored in `temp/` by default. Adjust log paths in each script as needed.

